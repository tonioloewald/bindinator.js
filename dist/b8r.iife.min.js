var b8r=function(){"use strict";const e={},t=/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform);var n=Object.freeze({__proto__:null,observerShouldBeRemoved:e,isMacOS:t});const{crypto:r}=window;class o extends TypeError{constructor(e,t,n){super(`${e} variable is not of type ${t} (value: '${n}')`),this.code="ERR_INVALID_ARG_TYPE"}}const s=r.getRandomValues.bind(r),a=[48,49,50,51,52,53,54,55,56,57,97,98,99,100,101,102],i=128;let c,l,d,u=0;r.randomUUID||(r.randomUUID=function(e){void 0!==e&&function(e,t){if(null===e||Array.isArray(e)||"object"!=typeof e)throw new o(t,"Object",e)}(e,"options");const{disableEntropyCache:t=!1}={...e};let n;!function(e,t){if("boolean"!=typeof e)throw new o(t,"boolean",e)}(t,"options.disableEntropyCache"),void 0===d&&((d=new Uint8Array(36))[8]=d[13]=d[18]=d[23]="-".charCodeAt(0),d[14]=52),t?(void 0===(n=l)&&(n=l=new Uint8Array(16)),s(n)):(void 0===c&&(c=new Uint8Array(16*i)),0===u&&s(c),u=(u+1)%i,n=c.slice(16*u,16*u+16)),n[8]=63&n[8]|128;let r=0;return d[0]=a[n[r]>>4],d[1]=a[15&n[r++]],d[2]=a[n[r]>>4],d[3]=a[15&n[r++]],d[4]=a[n[r]>>4],d[5]=a[15&n[r++]],d[6]=a[n[r]>>4],d[7]=a[15&n[r++]],d[9]=a[n[r]>>4],d[10]=a[15&n[r++]],d[11]=a[n[r]>>4],d[12]=a[15&n[r++]],d[15]=a[15&n[r++]],d[16]=a[n[r]>>4],d[17]=a[15&n[r++]],d[19]=a[n[r]>>4],d[20]=a[15&n[r++]],d[21]=a[n[r]>>4],d[22]=a[15&n[r++]],d[24]=a[n[r]>>4],d[25]=a[15&n[r++]],d[26]=a[n[r]>>4],d[27]=a[15&n[r++]],d[28]=a[n[r]>>4],d[29]=a[15&n[r++]],d[30]=a[n[r]>>4],d[31]=a[15&n[r++]],d[32]=a[n[r]>>4],d[33]=a[15&n[r++]],d[34]=a[n[r]>>4],d[35]=a[15&n[r]],String.fromCharCode.apply(null,d)});const f=()=>(()=>new Date(parseInt("1000000000",36)+Date.now()).valueOf().toString(36).slice(1))()+((e,t=36)=>{const n=t*t,o=new Uint32Array(Math.ceil(e/2));return r.getRandomValues(o),[...o].map(e=>(n+e%n).toString(t)).slice(1).join("").substr(-e)})(11),p=r.randomUUID.bind(r);let h=0;const m={},b={};function g(e){const[,t,,n,r]=e.match(/^(.*?)(([.[])(.*))?$/);return[t,"["===n?"["+r:r]}function y(e){if(!e||"/"===e)return[];if(Array.isArray(e))return e;{const n=[];for(;e.length;){var t=e.search(/\[[^\]]+\]/);if(-1===t){n.push(e.split("."));break}{const r=e.substr(0,t);e=e.substr(t),r&&n.push(r.split(".")),t=e.indexOf("]")+1,n.push(e.substr(1,t-2)),"."===e.substr(t,1)&&(t+=1),e=e.substr(t)}}return n}}function v(e,t){if(e&&!e._b8r_id_path?e._b8r_id_path=t:e._b8r_id_path!==t&&console.debug("b8r-error",`inconsistent id-path '${t}' used for array, expected '${e._b8r_id_path}'`),!e._b8r_value_maps){const t={};Object.defineProperty(e,"_b8r_value_maps",{get:()=>t})}const n={};return"_auto_"===t?e.forEach((e,t)=>{void 0===e._auto_&&(e._auto_=f()),n[e._auto_+""]=t}):e.forEach((e,r)=>{n[A(e,t)+""]=r}),e._b8r_value_maps[t]=n,n}function w(e,t,n){n+="";let r=function(e,t){return e._b8r_value_maps&&e._b8r_value_maps[t]?e._b8r_value_maps[t]:v(e,t)}(e,t)[n];return void 0!==r&&A(e[r],t)+""===n||(r=v(e,t)[n]),r}function $(e,t,n){return e[t]||(e[t]=n),e[t]}function E(e,t,n,r){let o=t?w(e,t,n):n;if(r===m)return e.splice(o,1),null;if(r===b)t||e[o]||(e[o]={});else if(r)if(void 0!==o)e[o]=r;else{if(!t||A(r,t)+""!=n+"")throw new Error(`byIdPath insert failed at [${t}=${n}]`);e.push(r),o=e.length-1}return e[o]}function _(e){if(!Array.isArray(e))throw console.debug("b8r-error","setByPath failed: expected array, found",e),new Error("setByPath failed: expected array")}function O(e){if(!e||e.constructor!==Object)throw console.debug("b8r-error","setByPath failed: expected Object, found",e),new Error("setByPath failed: expected object")}function A(e,t){const n=y(t);var r,o,s,a,i=e;for(r=0,o=n.length;i&&r<o;r++){var c=n[r];if(Array.isArray(c))for(s=0,a=c.length;i&&s<a;s++){i=i[c[s]]}else if(i.length)if(c.indexOf("=")>-1){const[e,...t]=c.split("=");i=E(i,e,t.join("="))}else i=i[s=parseInt(c,10)];else i="="===c[0]?i[c.substr(1)]:void 0}return void 0===i?null:i}function j(e,t,n){let r=e;const o=y(t);for(;r&&o.length;){const e=o.shift();if("string"==typeof e){const t=e.indexOf("=");if(t>-1){if(0===t?O(r):_(r),r=E(r,e.substr(0,t),e.substr(t+1),o.length?b:n),!o.length)return!0}else{_(r);const t=parseInt(e,10);if(!o.length)return n!==m?r[t]=n:r.splice(t,1),!0;r=r[t]}}else{if(!Array.isArray(e)||!e.length)throw console.debug("b8r-error","setByPath failed: bad path",t),new Error("setByPath failed");for(O(r);e.length;){const t=e.shift();if(!e.length&&!o.length)return n!==m?r[t]=n:delete r[t],!0;r=$(r,t,e.length?{}:[])}}}throw console.debug("b8r-error",`setByPath failed: "${t}" not found in`,e),new Error(`setByPath(${e}, ${t}, ${n}) failed`)}const x=e=>[...e],C=(e,t)=>{const n=Object.keys(e);for(const r of n)if(!1===t(e[r],r))break},k=e=>{if("object"!=typeof e||null===e)return e;if(Array.isArray(e))return e.map(e=>k(e));const t={};return C(e,(e,n)=>{t[n]=k(e)}),t},P=(e,t)=>{const n=Object.keys(e);for(const r of n)if(t(e[r],r))return r;return null},T=(e,t)=>(C(t,(t,n)=>{"function"!=typeof t&&(t&&t.constructor===Object?e[n]=T({},t):e[n]=t)}),e);var S=Object.freeze({__proto__:null,makeArray:x,last:e=>e.length?e[e.length-1]:null,forEach:(e,t)=>{for(let n=0;n<e.length&&!1!==t(e[n],n);n++);},forEachKey:C,deepClone:k,mapKeys:(e,t)=>{const n=Object.keys(e),r=[];for(const o of n)r.push(t(e[o],o));return r},mapEachKey:(e,t)=>{const n=Object.keys(e),r={};for(const o of n)r[o]=t(e[o],o);return r},findKey:P,findValue:(e,t)=>{const n=P(e,t);return n?e[n]:null},filterInPlace:(e,t)=>{for(let n=e.length-1;n>=0;n--)t(e[n],n)||e.splice(n,1)},filterKeys:(e,t)=>{const n=Object.keys(e),r=[];for(const o of n)t(e[o],o)&&r.push(o);return r},filterObject:(e,t)=>{const n=Object.keys(e),r={};for(const o of n)t(e[o],o)&&(r[o]=e[o]);return r},filterObjectInPlace:(e,t)=>{const n=Object.keys(e);for(const r of n)t(e[r],r)||delete e[r]},assignValues:T});const I={},N=(e,...t)=>{I[e]||(I[e]=document.createElement(e));const n=I[e].cloneNode();for(const e of t)if(e instanceof HTMLElement||"string"==typeof e||"number"==typeof e)n.append(e);else{const t=[],r=[];for(const o of Object.keys(e)){const s=e[o];if("bindList"===o)n.dataset.list=s;else if(o.includes("."))t.push(`${o}=${s}`);else if(o.match(/^(bind|on)[A-Z]/))o.startsWith("bind")?t.push(`${o.substr(4).replace(/[A-Z]/,e=>e.toLowerCase())}=${s}`):r.push(`${o.substr(2).replace(/[A-Z]/,e=>e.toLowerCase())}:${s}`);else if("style"===o)if("object"==typeof s)for(const e of Object.keys(s))n.style[e]=s[e];else n.setAttribute("style",s);else{const e=o.replace(/[A-Z]/g,e=>"-"+e.toLowerCase());"boolean"==typeof s?s?n.setAttribute(e,""):n.removeAttribute(e):n.setAttribute(e,s)}}t.length&&(n.dataset.bind=t.join("\n")),r.length&&(n.dataset.event=r.join("\n"))}return n},M=new Proxy({_comp:(...e)=>N("b8r-component",...e),_fragment:(...e)=>{const t=document.createDocumentFragment();for(const n of e)t.append(n);return t}},{get(e,t){if(!(t=t.replace(/[A-Z]/g,e=>`-${e.toLocaleLowerCase()}`)).match(/^\w+(-\w+)*$/))throw new Error(`${t} does not appear to be a valid element tagName`);return e[t]||(e[t]=((...e)=>N(t,...e))),e[t]},set(){throw new Error("You may not add new properties to elements")}}),L=(e,t)=>e&&"none"!==getComputedStyle(e).display&&(!t||e===document.body||L(e.parentElement,!0)),D=(e,t)=>!(e.top>t.top+t.height||e.top+e.height<t.top||e.left>t.left+t.width||e.left+e.width<t.left),B=e=>x(document.querySelectorAll(e)),R=document.querySelector.bind(document),q=(e,t,n)=>{const r=x(e.querySelectorAll(t));return n&&e.matches(t)&&r.unshift(e),r},F=(e,t)=>{for(;e.nextElementSibling&&!e.nextElementSibling.matches(t);)e=e.nextElementSibling;return e.nextElementSibling},W=(e,t,n,r)=>{let o=r?e:e.parentElement;const s=[];for(;o&&o!==document.body&&("string"!=typeof n||!o.matches(n))&&o!==n;)o.matches(t)&&s.push(o),o=o.parentElement;return s},H=document.getElementById.bind(document),U=document.createTextNode.bind(document),z=document.createDocumentFragment.bind(document);var J=Object.freeze({__proto__:null,isVisible:L,isInView:(e,t)=>{if(!e||!L(e,!0))return!1;const n=e.getBoundingClientRect(),r=t?t.getBoundingClientRect():{left:0,top:0,width:window.innerWidth,height:window.innerHeight};return D(n,r)},rectsOverlap:D,find:B,findOne:R,findWithin:q,findOneWithin:(e,t,n)=>n&&e.matches(t)?e:e.querySelector(t),succeeding:F,preceding:(e,t)=>{for(;e.previousElementSibling&&!e.previousElementSibling.matches(t);)e=e.previousElementSibling;return e.previousElementSibling},findAbove:W,id:H,text:U,fragment:z,classes:(e,t)=>{C(t,(t,n)=>{t?e.classList.add(n):e.classList.remove(n)})},styles:(e,t)=>{C(t,(t,n)=>{e.style[n]=t})},empty:e=>{for(;e.lastChild;)e.lastChild.remove()},elementIndex:e=>[...e.parentElement.children].indexOf(e),moveChildren:(e,t)=>{for(;e.firstChild;)t.appendChild(e.firstChild)},copyChildren:(e,t)=>{let n=e.firstChild;for(;n;)t.appendChild(n.cloneNode(!0)),n=n.nextSibling},wrap:(e,t,n)=>{try{const r=e.parentElement,o=n?t.querySelector(n):t;r.insertBefore(t,e),o.appendChild(e)}catch(e){throw new Error("wrap failed")}},unwrap:(e,t)=>{try{const n=t?e.closest(t):e.parentElement;n.parentElement.insertBefore(e,n),n.remove()}catch(e){throw new Error("unwrap failed")}},within:(e,t,n)=>{const r=e.getBoundingClientRect(),{clientX:o,clientY:s}=t;return o+n>r.left&&o-n<r.right&&s+n>r.top&&s-n<r.bottom},isInBody:e=>e&&document.body.contains(e),cssVar:(e,t,n)=>{if(e instanceof HTMLElement||([e,t,n]=[document.documentElement,e,t]),void 0===n)return getComputedStyle(e).getPropertyValue(t).trim();e.style.setProperty(t,n)},findHighestZ:(e="body *")=>[...document.querySelectorAll(e)].map(e=>parseFloat(getComputedStyle(e).zIndex)).reduce((e,t=Number.MIN_SAFE_INTEGER)=>isNaN(e)||e<t?t:e),create:N,elements:M});let V=null;const K=[],Z=[];let Q=()=>{};const Y=()=>{if(V)return V.cancel(),V=null,K.splice(0);if(K.length)throw new Error("_updateList is not empty but no _updateFrame set");return!1},G=(e,t)=>{const n=e?K.find(t=>e.startsWith(t.path)):K.find(e=>!e.path&&e.source&&e.source===t);n?e&&(n.source=t):(V||(V=(e=>{let t=!1;const n=()=>{t||e(),t=!0};return requestAnimationFrame(n),setTimeout(n,20),{cancel:()=>{t=!0}}})(Q)),K.push({path:e,source:t}))},X=e=>G(!1,e),ee=[],te=async e=>{e=e.toLocaleLowerCase(),window.customElements.get(e)||ee.includes(e)||(ee.push(e),await window.customElements.whenDefined(e),B(e).forEach(e=>{delete e._b8rBoundValues,X(e)}))},ne="[data-component],[data-initializing],b8r-component:not([data-component-id])",re=`[data-list],${ne}`,oe=e=>{if(!e.trim())throw new Error("empty binding");if(-1===e.indexOf("="))throw new Error(`binding "${e}" is missing = sign; probably need a source or target`);const[,t,n]=e.trim().match(/^([^=]*?)=([^;]*)$/m).map(e=>e.trim()),r=t.split(",").map(t=>{var n=t.match(/([\w#\-.]+)(\(([^)]+)\))?/);if(!n)return void console.debug("b8r-error","bad target",t,"in binding",e);if(!n)return null;if(n[1].includes("."))return{target:"method",key:n[1]};return{target:n[1].replace(/_([a-z])/g,(e,t)=>t.toUpperCase()),key:n[3]}});return n||console.debug("b8r-error","binding does not specify source",e),{targets:r,path:n}},se=e=>e.match(/(([^,([]+\.?)|(\[[^\]]+\]\.?)|\([^)]+\))+/g),ae=e=>{try{return e.dataset.bind.replace(/\n\s*([\w#\-.,]+)(\([^)]*\))?=/g,";$1$2=").split(";").filter(e=>!!e.trim()).map(oe)}catch(t){return console.debug("b8r-error",e,t),[]}},ie=e=>{const t=!!e&&e.closest("[data-path],[data-list-instance]"),n=t?t.dataset.path||t.dataset.listInstance:"";return-1===[".","["].indexOf(n[0])?n:ie(t.parentElement)+n},ce=(e,t)=>{t&&(e=e.closest(`.${t}-component`));const n=e.closest("[data-component-id]");return n?n.dataset.componentId:null},le=(e,t,n)=>{const r=new RegExp(`\\b${t}\\b`,"g");q(e,`[data-bind*="${t}"],[data-list*="${t}"],[data-path*="${t}"]`).forEach(e=>{["data-bind","data-list","data-path"].forEach(t=>{const o=e.getAttribute(t);o&&e.setAttribute(t,o.replace(r,n))})})},de=(e,t)=>{q(e,"[data-bind]",!0).filter(e=>!e.closest("[data-list]")).forEach(e=>{const n=e.dataset.bind;n.indexOf("=.")>-1&&(e.dataset.bind=n.replace(/=\.([^;\s]+)/g,`=${t}.$1`).replace(/=\./g,`=${t}`)),n.indexOf("${.")>-1&&(e.dataset.bind=n.replace(/\$\{(\.[^}]+)\}/g,"${"+t+"$1}"))})},ue=e=>e&&e.constructor===(async()=>{}).constructor,fe=e=>null===e?"null":Array.isArray(e)?"array":"number"==typeof e&&isNaN(e)?"NaN":"string"==typeof e&&e.startsWith("#")?e:e instanceof Promise?"promise":"function"==typeof e?e.constructor===(async()=>{}).constructor?"async":"function":typeof e,pe=e=>"-∞"===e?-1/0:"∞"===e[0]?1/0:parseFloat(e),he=(e,t)=>{let n,r;if(void 0===e)return!0;try{[,n,r]=(e||"").match(/^([[(]-?[\d.∞]+)?,?(-?[\d.∞]+[\])])?$/)}catch(t){throw new Error(`bad range ${e}`)}if(n){const e=pe(n.substr(1));if("("===n[0]){if(t<=e)return!1}else if(t<e)return!1}if(r){const e=pe(r);if(r.endsWith(")")){if(t>=e)return!1}else if(t>e)return!1}return!0},me={},be=(e,t)=>{const[,n,r,,o]=e.match(/^#([?]?)([^\s]+)(\s(.*))?$/)||[];if(n&&(null===t||void 0===t))return!0;const s=fe(t);switch(r){case"forbidden":return!1;case"any":return null!==t&&void 0!==t;case"native":return"function"==typeof t&&"function () { [native code] }"===t.toString()&&(!e||(ue(t)?e.match(/^async\b/):e.match(/^function\b/)));case"function":return"function"===s;case"number":return"number"===s&&he(o,t);case"int":return"number"===s&&t===Math.floor(t)&&he(o,t);case"union":return!!o.split("||").find(e=>be(`#${e}`,t));case"enum":try{return o.split("|").map(JSON.parse).includes(t)}catch(e){throw new Error(`bad enum specification (${o}), expect JSON strings`)}case"void":return"undefined"===s||"null"===s;case"nothing":return"undefined"===s;case"string":return"string"===s;case"regexp":return"string"===s&&(t=t,(me[o=o]?me[o]:me[o]=new RegExp(o)).test(t));case"array":return Array.isArray(t);case"instance":return t instanceof window[o];case"promise":return t instanceof Promise;case"object":return!!t&&"object"==typeof t&&!Array.isArray(t);default:return s===r||(console.error("got",t,`expected "${e}", "${s}" does not match "${r}"`),!1)}};var ge,ye;const ve=/^((async\s+)?function)?\s*\((.*?)\)\s*(=>)?\s*\{/,we=/^((\.\.\.\w+)|(\w+)|\((.*?)\))\s*=>\s*[^\s{]/,$e=/\w+\s*=>\s*[^\s{]|\breturn\b/,Ee=e=>{const t=fe(e);switch(t){case"array":return e.map(Ee);case"object":{const t={};return Object.keys(e).forEach(n=>{t[n]=Ee(e[n])}),t}case"function":case"async":{const n=e.toString();if(n.startsWith("class "))return"class";if(n.endsWith("() { [native code] }"))return`native ${t}`;const r=n.match(ve),o=n.match(we),s=n.match($e)||n.match(we);return`${t} ( ${(r&&r[3]||o&&(o[2]||o[3]||o[4])||"").trim().split(",").map(e=>{const[t]=e.split("=");return`${t} #any`}).join(", ")} ) => ${s?"#any":"#nothing"}`}default:return t}},_e=e=>JSON.stringify(Ee(e));const Oe=(e,t,n=[],r="")=>{const o=fe(e),s=fe(t);if(o.startsWith("#")?be(o,t):o===s)if("array"===o){const o=!!t.length&&function*(e){let t=0;const n=Math.ceil(e.length/101);for(;t<e.length;)t<5?(yield{sample:e[t],i:t},t++):t>e.length-5?(yield{sample:e[t],i:t},t++):(yield{sample:e[t],i:t},t=Math.min(t+n,e.length-4))}(t);if(1===e.length&&o)for(const{sample:t,i:s}of o)Oe(e[0],t,n,`${r}[${s}]`);else if(e.length>1&&o)for(const{sample:t,i:s}of o){let o=!1;for(const n of e)if(0===Oe(n,t,[],"").length){o=!0;break}o||n.push(`${r}[${s}] had no matching type`)}}else"object"===o&&xe(e,t,n,r);else n.push(`${r?r+" ":""}was ${(e=>"string"==typeof e?`"${e}"`:"object"==typeof e?fe(e):e)(t)}, expected ${o}`);return n},Ae=(e,t)=>{const n=Array.isArray(t)?[...t]:t.replace(/\[[^\]]*\]/g,".*").split(".");if(null===e||void 0===e||0===n.length)return e;{const t=n.shift();return"*"===t?Array.isArray(e)?1===e.length?Ae(e[0],n):Ae(Object.assign({},...e),n):void 0:Ae(e[t],n)}},je=/^[a-zA-Z_$][a-zA-Z_$0-9]*$/,xe=(e,t,n=[],r="")=>{const o=new Set;for(const s of Object.keys(e))if(s.startsWith("#")){let a=je;try{"#"!==s&&(a=new RegExp(`^${s.substr(1)}$`))}catch(e){const t=`illegal regular expression in example key '${s}'`;n.push(t),console.error(t)}const i=Object.keys(t).filter(e=>a.test(e));for(const a of i)o.has(a)||(Oe(e[s],t[a],n,`${r}./^${s.substr(1)}$/:${a}`),o.add(a))}else if(s.endsWith("?")){const a=s.substr(0,s.length-1);Object.hasOwnProperty.call(t,a)&&(o.has(a)||(Oe(e[s],t[a],n,r+"."+a),o.add(a)))}else o.has(s)||(Oe(e[s],t[s],n,r+"."+s),o.add(s));return n};class Ce{constructor({functionName:e,isParamFailure:t,expected:n,found:r,errors:o}){Object.assign(this,{functionName:e,isParamFailure:t,expected:n,found:r,errors:o})}toString(){const{functionName:e,isParamFailure:t,errors:n}=this;return`${e} failed: bad ${t?"parameter":"result"}, ${JSON.stringify(n)}`}}const ke=(e,t)=>{for(let e=0;e<t.length;e++)if(t[e]instanceof Ce)return t[e];const n=e.map((e,n)=>Oe(e,t[n]));return n.flat().length?n:[]};function Pe(e,t){const n=fe(e);switch(n){case"array":return`Array<${e.length?Pe(e[0]):"any"}>`;case"object":return`{${Object.keys(e).map(t=>`${t}: ${Pe(e[t],null)}`).join(", ")}}`;case"null":case"undefined":return"any";default:switch(Ee(e).split(" ")[0]){case"class":return`class ${t||""} { constructor(...args: any[]) }`;case"async":case"function":return function(e,t){const n=e.toString(),r=n.match(ve),o=n.match(we),s=n.match($e)||n.match(we),a=(r&&r[3]||o&&(o[2]||o[3]||o[4])||"").trim(),i=a?a.split(",").map(e=>{const[t]=e.split("=");return`${t.trim()}: any`}):[];return t?`${ue(e)?"async ":""}function ${t} (${i.join(", ")}): ${s?"any":"void"}`:`(${i.join(", ")}) => ${s?"any":"void"}`}(e,t);case"native":return`function ${t} (...args:any[]): any  /* native */`}return n}}var Te=Object.freeze({__proto__:null,isAsync:ue,describe:fe,specificTypeMatch:be,describeType:Ee,typeJSON:_e,typeJS:e=>_e(e).replace(/"(\w+)":/g,"$1:"),matchType:Oe,exampleAtPath:Ae,TypeError:Ce,matchParamTypes:ke,typeSafe:(e,t=[],n,r)=>{const o=ke(["#function","#?array","#?any","#?string"],[e,t,n,r]);if(o instanceof Ce)return o;r||(r=e.name||"anonymous");let s=0;return((e,t)=>{t={...t};for(const n of Object.keys(t)){const r=t[n];Object.defineProperty(e,n,{enumerable:!0,get:()=>r,set(e){throw new Error(`${n} is read-only`)}})}return e})(function(...o){s+=1;const a=ke(t,o);if(a instanceof Ce)return a;if(0===a.length){const t=e(...o),s=Oe(n,t);return 0===s.length?t:new Ce({functionName:r,isParamFailure:!1,expected:n,found:t,errors:s})}return new Ce({functionName:r,isParamFailure:!0,expected:t,found:o,errors:a})},{paramTypes:t,resultType:n,getCallCount:()=>s})},tsDeclaration:function(e){return Object.keys(e).sort().map(t=>{const n=e[t];return"function"==typeof n?`declare ${Pe(n,t)}`:`declare const ${t}: ${Pe(n)}`}).join("\n")}});const Se=[],Ie=[],Ne=()=>{Ie.forEach(e=>e())},Me=e=>{const t=Se.indexOf(e);t>-1&&Se.splice(t,1),Ne()},Le=(e,t,n,r)=>new Promise(function(o,s){(r=r||{}).headers||(r.headers={});var a=new XMLHttpRequest;for(var i in Se.push(a),Ne(),a.open(t||"GET",e,!0),a.onreadystatechange=(()=>{if(a.readyState===XMLHttpRequest.DONE)switch(Math.floor(a.status/100)){case 0:case 5:case 4:Me(a),s(a);break;case 3:break;case 2:Me(a),o(a.responseText)}}),"object"==typeof n&&(n=JSON.stringify(n),r.headers["Content-Type"]="application/json; charset=utf-8"),r.headers)a.setRequestHeader(i,r.headers[i]);a.send(n)});let De=0;var Be=Object.freeze({__proto__:null,ajax:Le,xml:(e,t,n,r)=>new Promise(function(o,s){Le(e,t,n,r).then(e=>{try{o((new DOMParser).parseFromString(e,"text/xml"))}catch(t){console.debug("b8r-error","Failed to parse data",e,t),s(t,e)}},s)}),json:(e,t,n,r)=>new Promise(function(o,s){Le(e,t,n,r).then(e=>{try{o(JSON.parse(e||"null"))}catch(t){console.debug("b8r-error","Failed to parse data",e,t),s(t,e)}},s)}),jsonp:(e,t="callback",n=2e3)=>new Promise(function(r,o){const s=`_b8r_jsonp_callback_${++De}`,a=document.createElement("script"),i=()=>{delete window[s],document.body.removeChild(a)};window[s]=(e=>{i(),r(e)}),setTimeout(()=>{a.parentElement&&(i(),o(new Error("request timed out")))},n),a.src=e+`&${t}=${s}`,document.body.appendChild(a)}),ajaxRequestsInFlight:()=>Se,onRequest:e=>{-1===Ie.indexOf(e)&&Ie.push(e)},offRequest:e=>{const t=Ie.indexOf(e);t>-1&&Ie.splice(t,1)}});const Re=async function(){}.constructor;var qe=Object.freeze({__proto__:null,AsyncFunction:Re,debounce:(e,t)=>{let n;return(...r)=>{n&&clearTimeout(n),n=setTimeout(()=>{e(...r)},t)}},delay:(e,t=null)=>new Promise((n,r)=>{setTimeout(()=>n(t),e)}),throttle:(e,t)=>{let n=Date.now()-t,r=!1;return(...o)=>{const s=Date.now();if(!r&&s-n>=t){r=!0;try{e(...o)}finally{n=s,r=!1}}}},throttleAndDebounce:(e,t)=>{let n,r=Date.now()-t,o=!1;return(...s)=>{if(clearTimeout(n),n=setTimeout(async()=>e(...s),t),!o&&Date.now()-r>=t){o=!0;try{e(...s),r=Date.now()}finally{o=!1}}}},memoize:e=>{if(e._isMemoized)return e;let t,n=[];const r=function(...r){const o=[this,...r];return(void 0===t||o.filter((e,t)=>e!==n[t]).length)&&(n=o,t=e.call(this,...r)),t};return r._isMemoized=!0,r}});const Fe={},We=[],He={},Ue={},ze=({name:e,css:t,html:n,view:r})=>{if(r){const e=r(M);r=Array.isArray(e)?M.div(...e):M.div(e)}else(r=N("div")).innerHTML=n||"";const o=`${e}-component`,s=!!t&&((e,t)=>{const n=!!e&&N("style");return n&&(n.type="text/css",n.id=t,n.appendChild(U(e)),document.head.appendChild(n)),n})(t.replace(/_component_/g,o),o);for(const e of q(r,'[class*="_component_"]'))e.setAttribute("class",e.getAttribute("class").replace(/_component_/g,o));return{style:s,view:r}},Je=function(e,{css:t,html:n,view:r,load:o,initialValue:s,type:a}){let i;({style:i,view:r}=ze({name:e,css:t,html:n,view:r}));const c={version:2,name:e,style:i,view:r,path:`inline-${e}`,initialValue:s,type:a};if(a){if(!a||"object"!=typeof a)throw new Error(`component ${e} has bad type, object expected`);Ue[e]=a}return o&&(c.load=(async(e,t,n,r,s,a,i,c,l,d)=>{o({component:e,b8r:t,data:s,find:n,findOne:r,get:i,set:c,on:l,touch:d})})),We[e]&&clearInterval(We[e]),B(`[data-component="${e}"]`).forEach(t=>{t.closest("[data-list]")||t.dataset.component!==e||G(!1,t)}),Fe[e]&&console.debug("b8r-warn","component %s has been redefined",e),Fe[e]=c,c},Ve=(e,t,n,r)=>{if("object"!=typeof e||t){if("object"==typeof t&&void 0===n)return Je(e,t)}else t=e,e=`doe-${(()=>(h?console.debug("unique() is deprecated, use id() instead"):console.warn("unique() is deprecated, use id() instead"),h+=1))()}`;let o,s,a,i=!1,c=!1;n||(n=p()),3===(s=t.split(/<style>|<\/style>/)).length?[,i,a]=s:a=t,(s=a.split(/<script[^>\n]*>|<\/script>/)).length>=3?[o,c]=s:o=a;const{style:l,view:d}=ze({css:i,html:o,name:e});let u=()=>console.debug("b8r-error","component",e,"cannot load properly");c&&c.match(/[\b_]require\b/)&&!c.match(/\belectron-require\b/)&&(console.debug("b8r-error",`in component "${e}" replace require with await import()`),c=!1);try{u=!!c&&new Re("component","b8r","find","findOne","data","register","get","set","on","touch",`${c}\n//# sourceURL=${e}(component)`)}catch(t){throw console.debug("b8r-error","error creating load method for component",e,t,c),new Error(`component ${e} load method could not be created`)}const f={name:e,style:l,view:d,load:u,path:n.split("/").slice(0,-1).join("/")};return f.path,r&&(f._source=t),We[e]&&clearInterval(We[e]),Fe[e]&&(Fe[e].style&&Fe[e].style.remove(),console.debug("b8r-warn","component %s has been redefined",e)),Fe[e]=f,B(`[data-component="${e}"]`).forEach(t=>{t.closest("[data-list]")||t.dataset.component!==e||G(!1,t)}),f};let Ke;let Ze;const Qe=e=>Ze[e.target],Ye={_b8r_:{echo:e=>console.log(e)||!0,stopEvent:()=>{},_update_:e=>{let t=W(e.target,"[data-bind]",null,!0);if("SELECT"===e.target.tagName){const n=q(e.target,"option[data-bind]:not([data-list])");t=t.concat(n)}return t.filter(e=>!e.matches("[data-list]")).forEach(e=>{e.matches("[data-debug],[data-debug-bind]")&&console.debug("b8r-warn","Add a conditional breakpoint here to debug changes to the registry triggered by events");const t=ae(e);for(let n=0;n<t.length;n++){const{targets:r,path:o}=t[n],s=t=>{const n=Ze[t.target](e,t.key);void 0!==n&&(delete e._b8rBoundValues,Ke(o,n,e))};r.filter(Qe).forEach(s)}}),!0}}},Ge={},Xe=[],et=/^\.?([^.[\](),])+(\.[^.[\](),]+|\[\d+\]|\[[^=[\](),]*=[^[\]()]+\])*$/,tt=e=>et.test(e);class nt{constructor(e,t){if(this._orig_test=e,"string"==typeof e)this.test=(t=>"string"==typeof t&&t.startsWith(e));else if(e instanceof RegExp)this.test=e.test.bind(e);else{if(!(e instanceof Function))throw new Error("expect listener test to be a string, RegExp, or test function");this.test=e}if("string"==typeof t)this.callback=((...e)=>{st(t)?mt(t,...e):bt(this)});else{if("function"!=typeof t)throw new Error("expect callback to be a path or function");this.callback=t}Xe.push(this)}}const rt=(e,t)=>{if("."===e[0]){if(!t)throw new Error("cannot evaluate relative path without element");e=ie(t)+e}else if("_data_"===e.substr(0,6)){if(!t)throw new Error("cannot evaluate _data_ path without element");e=ie(t)+e.substr(6)}else if("_component_"===e.substr(0,11)){if(!t)throw new Error("cannot evaluate _component_ path without element");e=ce(t)+e.substr(11)}return e},ot=(e,t)=>{if(")"===e.substr(-1))return((e,t)=>{const[,n,r]=e.match(/([^(]+)\(([^)]+)\)/);return-1===r.indexOf(",")?mt(n,st(r,t)):mt(n,...st(r,t))})(e,t);if(e.startsWith(".")){const n=t&&t.closest("[data-list-instance]");return!n&&t.closest("body")&&console.debug("b8r-error",`relative data-path ${e} used without list instance`,t),n?A(Ye,`${n.dataset.listInstance}${e}`):void 0}if(e=rt(e,t),tt(e))return A(Ye,e);console.debug("b8r-error",`getting invalid path ${e}`)},st=(e,t)=>{const n=se(e);return 1===n.length?ot(n[0],t):n.map(e=>ot(e,t))},at=(t,n)=>{Xe.filter(n=>{let r;try{r=n.test(t)}catch(e){console.debug("b8r-error",n,"test threw exception",e)}return r===e?(bt(n),!1):!!r}).forEach(r=>{try{r.callback(t,n)===e&&bt(r)}catch(e){console.debug("b8r-error",r,"callback threw exception",e)}})},it=(e,t)=>{console.debug("b8r-error",`registry type check(s) failed after ${t}`,e)};let ct=[it];const lt=e=>(dt(it),-1===ct.indexOf(e)&&(ct.push(e),!0)),dt=(e,t=!1)=>{const n=ct.length;return ct=ct.filter(t=>t!==e),t&&lt(it),ct.length!==n-1},ut=(e,t)=>{const n=t.startsWith("c#")?Ue[t.split("#")[1]]:Ge[t];if(!n||!Ye[t])return;const r=Oe(n,Ye[t],[],t);r.length&&ct.forEach(t=>t(r,e))},ft=(e,t,n)=>{if(t&&t._b8r_sourcePath)throw new Error("You cannot put reg proxies into the registry");tt(e)||console.debug("b8r-error",`setting invalid path ${e}`);const r=e.split(/\.|\[/),[o]=r,s=r[0],a=A(Ye,e);if(r.length>1&&!Ye[s])console.debug("b8r-error",`cannot set ${e} to ${t}, ${s} does not exist`);else{if(1===r.length&&"object"!=typeof t)throw new Error(`cannot set ${e}; you can only register objects at root-level`);t===a?(Array.isArray(t)||Array.isArray(a))&&at(e,n):t&&t.constructor?1!==r.length||Ye[e]?(t.constructor===Object&&a&&a.constructor===Object?j(Ye,e,Object.assign(t,Object.assign(a,t))):j(Ye,e,t),at(e,n)):ht(e,t):(j(Ye,e,t),at(e,n))}return ut(`set('${e}',...)`,o),t},pt=(e,t)=>{Ye[e]&&Ye[e]!==t?console.debug("b8r-warn",`${e} already registered; if intended, remove() it first`):(Ye[e]=t,ut(`register('${e}')`,e))},ht=(e,t,n)=>{if(e.match(/^_[^_]*_$/))throw new Error("cannot register object as "+e+", all names starting and ending with a single '_' are reserved.");pt(e,t),n||at(e)},mt=(e,...t)=>{const n=st(e);if(n instanceof Function)return n(...t);console.debug("b8r-error",`cannot call ${e}; not a method`)},bt=e=>{let t,n=!1;if(e instanceof nt)(t=Xe.indexOf(e))>-1?Xe.splice(t,1):console.debug("b8r-error","unobserve failed, listener not found");else if(e)for(let t=Xe.length-1;t>=0;t--)Xe[t]._orig_test===e&&(Xe.splice(t,1),n=!0);return n},gt=(e,t=!0)=>{const[,n]=e.match(/^(.*)\[[^[]*\]$/)||[];if(n){const r=A(Ye,n),o=A(Ye,e),s=r.indexOf(o);-1!==s&&(r.splice(s,1),t&&at(n))}else null!==A(yt=Ye,e=e)&&j(yt,e,m),t&&at(e)};var yt,vt;const wt=(e,t)=>st(t?e+("["===t[0]?t:"."+t):e),$t=(e,t)=>""===e?t:t.match(/^\d+$/)||t.includes("=")?`${e}[${t}]`:`${e}.${t}`,Et=(e="")=>({get(t,n){const r="symbol"!=typeof n&&(n.match(/^([^.[]+)\.(.+)$/)||n.match(/^([^\]]+)(\[.+)/)||n.match(/^(\[[^\]]+\])\.(.+)$/)||n.match(/^(\[[^\]]+\])\[(.+)$/));if(r){const[,n,o]=r,s=$t(e,n),a=A(t,n);return a&&"object"==typeof a?new Proxy(a,Et(s))[o]:a}if("_b8r_sourcePath"===n)return e;if("_b8r_value"===n)return t;if(n.startsWith("[")&&n.endsWith("]")&&(n=n.substr(1,n.length-2)),Object.prototype.hasOwnProperty.call(t,n)||Array.isArray(t)&&"string"==typeof n&&n.includes("=")){let r;if("symbol"==typeof n&&(r=t[n]),n.includes("=")){const[e,o]=n.split("=");r=t.find(t=>`${A(t,e)}`===o)}else r=t[n];if(!r||"object"!=typeof r||r.constructor!==Object&&r.constructor!==Array)return"function"==typeof r?r.bind(t):r;{const t=$t(e,n);return new Proxy(r,Et(t))}}return Array.isArray(t)?"function"==typeof t[n]?(...r)=>{const o=Array.prototype[n].apply(t,r);return at(e),o}:t[n]:void 0},set(t,n,r){if(r&&r._b8r_sourcePath)throw new Error("You cannot put reg proxies into the registry");return ft($t(e,n),r),!0}}),_t=new Proxy(Ye,Et());var Ot=Object.freeze({__proto__:null,onTypeError:lt,offTypeError:dt,get:st,getJSON:(e,t,n)=>{const r=st(e,t),o=[];return JSON.stringify(r,(e,t)=>t&&"object"==typeof t?"object"==typeof t?t.constructor!==Object&&t.constructor!==Array?`[${t.constructor.name}]`:-1===o.indexOf(t)?(o.push(t),t):"[duplicate or circular reference]":void 0:t,n?2:0)},getByPath:wt,set:ft,replace:(e,t)=>("object"==typeof t&&j(Ye,e,null),ft(e,t),t),setJSON:(e,t)=>ft(e,JSON.parse(t)),increment:e=>ft(e,st(e)+1),decrement:e=>ft(e,st(e)-1),zero:e=>ft(e,0),push:(e,t,n)=>{const r=st(e)||[];Array.isArray(r)&&(r.push(t),n&&n(r)),ft(e,r)},unshift:(e,t)=>{const n=st(e)||[];Array.isArray(n)&&n.unshift(t),ft(e,n)},sort:(e,t)=>{const n=st(e)||[];Array.isArray(n)&&n.sort(t),ft(e,n)},call:mt,callIf:(e,...t)=>{const n=st(e);return n instanceof Function?n(...t):null},touch:at,observe:(e,t)=>new nt(e,t),unobserve:bt,models:()=>Object.keys(Ye),_register:pt,checkType:ut,reg:_t,registerType:(e,t)=>{Ge[e]=t,ut(`registerType('${e}')`,e)},types:()=>JSON.parse(JSON.stringify({registeredTypes:Ge,componentTypes:Ue})),register:ht,registered:e=>!!Ye[e.split(".")[0]],remove:gt,deregister:e=>{console.debug("b8r-warn","deregister is deprecated, use b8r.remove"),gt(e)},resolvePath:rt,isValidPath:tt});const At={},jt=new Image;jt.src=(e=>{const t=document.createElement("canvas");t.width=1,t.height=1;const n=t.getContext("2d");return n.fillStyle=e||"rgba(255,255,255,0.3)",n.fillRect(0,0,1,1),t.toDataURL()})();const xt=new Promise(e=>e(jt)),Ct=(e,t,n=!0)=>{e instanceof HTMLImageElement&&e.src===t||(e.src=jt.src,e.style.opacity=.1,((e,t=!0)=>e?At[e]?At[e]:(At[e]=new Promise(n=>{const r=new Image;t&&r.setAttribute("crossorigin","anonymous"),r.src=e,r.onload=(()=>{n(r)}),r.onerror=(()=>{n(jt)})}),At[e]):xt)(t,n).then(t=>{if(getComputedStyle(e).transition||(e.style.transition="var(--hover-transition)"),e.style.opacity="",e.classList.add("-b8r-rendered"),e instanceof HTMLCanvasElement){e.width=e.offsetWidth,e.height=e.offsetHeight;const n=e.getContext("2d"),r=e.offsetWidth,o=e.offsetHeight,s=Math.max(r/t.width,o/t.height),a=r/s,i=o/s,c=.5*(t.width-a),l=.5*(t.height-i);n.drawImage(t,c,l,a,i,0,0,r,o)}else e.setAttribute("src",t.src)}))},kt=document.createElement("div"),Pt=e=>{const t=[];return e.altKey&&t.push("alt"),e.ctrlKey&&t.push("ctrl"),e.metaKey&&t.push("meta"),e.shiftKey&&t.push("shift"),t.push((e=>{if(e.code)return e.code.replace(/Key|Digit/,"");{let t=e.key;return"U+"===t.substr(0,2)&&(t=String.fromCharCode(parseInt(e.key.substr(2),16))),t}})(e)),t.join("-")},Tt=t?{meta:"⌘",ctrl:"⌃",alt:"⌥",escape:"⎋",shift:"⇧"}:{meta:"Meta",ctrl:"Ctrl",alt:"Alt",escape:"Esc",shift:"Shift"};var St=["mousedown","mouseup","click","dblclick","mouseleave","mouseenter","mousemove","mouseover","mouseout","mousewheel","scroll","contextmenu","dragstart","dragenter","dragover","dragleave","dragend","drop","transitionend","animationend","input","change","keydown","keyup","cut","copy","paste","focus","blur","focusin","focusout"];const It=e=>{var t,n,r,o,s=!1;if("object"==typeof e[2])return console.debug("b8r-warn","b8r.on(element, type, OBJECT) is deprecated"),[t,n,r]=e,Dt(t,n,r.model,r.method);if(e.length>4||"string"==typeof e[3]){if([t,n,r,o,s]=e,"string"!=typeof r||"string"!=typeof o)return void console.debug("b8r-error","implicit bindings are by name, not",r,o);o=r+"."+o}else[t,n,o,s]=e;if(!(t instanceof Element))throw console.debug("b8r-error","bind bare elements please, not",t),new Error("bad argument");return{element:t,eventType:n,path:o,prepend:s}},Nt=e=>{const t=e.dataset.event;return t?t.replace(/\s*(^|$|[,:;])\s*/g,"$1").split(/[;\n]/).filter(e=>e.trim()):[]},Mt=e=>{const t=Nt(e);try{return t.map(function(t){const[n,r]=t.split(":");if(!r)return t.indexOf(".")?console.debug("b8r-error","bad event handler (missing event type)",t,"in",e):console.debug("b8r-error","bad event handler (missing handler)",t,"in",e),{types:[]};const o=r.trim().match(/^([^.]+)?\.(.+)$/);if(!o)throw new Error(`bad event handler "${r}"`);const[,s,a]=o,i=n.split(",").sort();return{types:i.map(e=>e.split("(")[0].trim()),typeArgs:i.map(e=>{"key"===e.substr(0,3)&&(e=(e=e.replace(/Key|Digit/g,"")).replace(/CmdOrCtrl/g,navigator.userAgent.indexOf("Macintosh")>-1?"meta":"ctrl"));var t=e.match(/\(([^)]+)\)/);return!(!t||!t[1])&&t[1].split(",")}),model:s,method:a}})}catch(e){return console.debug("b8r-error","fatal error in event handler",e),[]}},Lt=(e,t)=>{if("string"==typeof e&&(e=[e]),Array.isArray(e))return e.sort().join(",")+":"+t;console.debug("b8r-error","makeHandler failed; bad eventType",e)};function Dt(...e){const{element:t,eventType:n,path:r,prepend:o}=It(e),s=Lt(n,r),a=Nt(t);-1===a.indexOf(s)&&(o?a.unshift(s):a.push(s),t.dataset.event=a.join(";"))}function Bt(...e){var t,n,r,o;if(4===e.length)[t,n,r,o]=e,o=r+"."+o;else{if(3!==e.length)throw new Error("b8r.off requires three or four arguments");[t,n,o]=e}const s=t.dataset.event.split(";"),a=Lt(n,o),i=s.indexOf(a);i>-1&&(s.splice(i,1),s.length?t.dataset.event=s.join(";"):t.dataset.event&&delete t.dataset.event)}window.TouchEvent&&["touchstart","touchcancel","touchmove","touchend"].forEach(e=>St.push(e));const Rt=function(e,t){var n=!1;for(e=e.closest("[data-component-id]");e instanceof Element;){if(st(`${e.dataset.componentId}.${t}`)instanceof Function){n=e.dataset.componentId;break}e=e.parentElement.closest("[data-component-id]")}return n},qt=(...e)=>{var t,n;try{e[0].match(/[[.]/)?([n,...e]=e,[t,n]=g(n)):[t,n,...e]=e}catch(e){throw new Error("callMethod has bad arguments")}return mt(`${t}.${n}`,...e)},Ft=e=>{if(!e.target.closest("[data-list],b8r-component:not([data-component-id]),[data-component]:not([data-component-id])")){e.target.closest("[data-debug],[data-debug-event]")&&console.debug("b8r-warn","Add a conditional breakpoint to watch events being handled");for(var t=kt,n=e.args||[],r=e instanceof KeyboardEvent?Pt(e):{};t;){for(var o=Mt(t),s=!1,a=0;a<o.length;a++)for(var i=o[a],c=0;c<i.types.length;c++)if(i.types[c]===e.type&&(!i.typeArgs[c]||i.typeArgs[c].indexOf(r)>-1)){if(i.model&&i.method)"_component_"===i.model&&(i.model=Rt(t,i.method)),i.model?s=qt(i.model,i.method,e,t,...n):console.debug("b8r-warn",`${i.method} not found`,t,i);else{if(i.model||!i.method){console.debug("b8r-error","incomplete event handler on",t);break}{const r=t.closest("[data-list-instance]").dataset.listInstance;r?s=qt(`${r}.${i.method}`,e,t,...n):console.debug("b8r-error","incomplete event handler on",t)}}if(!0!==s)return e.stopPropagation(),void e.preventDefault()}t=t===kt?e.target.closest("[data-event]"):t.parentElement.closest("[data-event]")}}},Wt=(e,t,...n)=>{if("string"==typeof e&&t instanceof Element)if(t){const r=((e,t,...n)=>{const r=new Event(e);return r.args=n,t.dispatchEvent(r),r.target!==t?{type:e,target:t,args:n}:r})(e,t,...n);t instanceof Element&&-1===St.indexOf(e)&&Ft(r)}else console.debug("b8r-warn","b8r.trigger called with no specified target");else console.debug("b8r-error","expected trigger(eventType, targetElement)",e,t)};const Ht=(Ut=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,zt=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,Jt=/[^-+\dA-Z]/g,Vt=function(e,t){for(e=String(e),t=t||2;e.length<t;)e="0"+e;return e},function(e,t,n){var r=Ht;if(1!=arguments.length||"[object String]"!=Object.prototype.toString.call(e)||/\d/.test(e)||(t=e,e=void 0),e=e?new Date(e):new Date,isNaN(e))throw SyntaxError("invalid date");"UTC:"==(t=String(r.masks[t]||t||r.masks.default)).slice(0,4)&&(t=t.slice(4),n=!0);var o=n?"getUTC":"get",s=e[o+"Date"](),a=e[o+"Day"](),i=e[o+"Month"](),c=e[o+"FullYear"](),l=e[o+"Hours"](),d=e[o+"Minutes"](),u=e[o+"Seconds"](),f=e[o+"Milliseconds"](),p=n?0:e.getTimezoneOffset(),h={d:s,dd:Vt(s),ddd:r.i18n.dayNames[a],dddd:r.i18n.dayNames[a+7],m:i+1,mm:Vt(i+1),mmm:r.i18n.monthNames[i],mmmm:r.i18n.monthNames[i+12],yy:String(c).slice(2),yyyy:c,h:l%12||12,hh:Vt(l%12||12),H:l,HH:Vt(l),M:d,MM:Vt(d),s:u,ss:Vt(u),l:Vt(f,3),L:Vt(f>99?Math.round(f/10):f),t:l<12?"a":"p",tt:l<12?"am":"pm",T:l<12?"A":"P",TT:l<12?"AM":"PM",Z:n?"UTC":(String(e).match(zt)||[""]).pop().replace(Jt,""),o:(p>0?"-":"+")+Vt(100*Math.floor(Math.abs(p)/60)+Math.abs(p)%60,4),S:["th","st","nd","rd"][s%10>3?0:(s%100-s%10!=10)*s%10]};return t.replace(Ut,function(e){return e in h?h[e]:e.slice(1,e.length-1)})});var Ut,zt,Jt,Vt;Ht.masks={default:"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"},Ht.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]},Date.prototype.format=function(e,t){return Ht(this,e,t)};const Kt=(e,t)=>"string"==typeof e||"string"==typeof t?`${e}`.localeCompare(t):e>t?1:t>e?-1:0,Zt=(e,t)=>"string"==typeof e||"string"==typeof t?`${t}`.localeCompare(e):e>t?-1:t>e?1:0,Qt=e=>e;var Yt=Object.freeze({__proto__:null,sortAscending:Kt,sortDescending:Zt,makeAscendingSorter:(e=Qt)=>(t,n)=>Kt(e(t),e(n)),makeDescendingSorter:(e=Qt)=>(t,n)=>Zt(e(t),e(n))});var Gt=Object.freeze({__proto__:null,value:e=>{let t=e.dataset.pendingValue;if(t&&(t=JSON.parse(t),e.value=t,e.value===t&&e.dataset.pendingValue&&delete e.dataset.pendingValue),e.matches("input[type=radio]")){const t=e.getAttribute("name"),n=B(`input[type=radio][name=${t}]`).find(e=>e.checked);return n?n.value:null}return e.matches("[data-type=number],input[type=number],input[type=range]")?parseFloat(e.value):e.dataset.componentId?st(`${e.dataset.componentId}.value`):e.value},checked:e=>e.indeterminate?null:e.checked,selected:e=>e.selected,text:e=>e.textContent,currentTime:e=>e.currentTime,playbackRate:e=>e.playbackRate,prop:(e,t)=>e[t],component:(e,t)=>{const n=e.dataset.componentId;return wt(n,t)},fromMethod:(e,t)=>{let[n,...r]=t.split(".");return r=r.join("."),wt(n,r)(e)}});const Xt=[],en=e=>{for(var t=0;t<Xt.length;t++)Xt[t].targetElement===e&&delete Xt[t].data},tn=e=>{var t,n,r,o;return 2===e.length?[t,o]=e:([t,n,r]=e,o=n+"."+r),{eventType:t,path:o}},nn=(e,{content:t=!1,attributes:n={},styles:r={},classes:o=[]})=>{const s=document.createElement(e);return cn(s,t),Object.keys(n).forEach(e=>s.setAttribute(e,n[e])),Object.keys(r).forEach(e=>{s.style[e]=r[e]}),o.forEach(e=>s.classList.add(e)),s},rn=(e,t)=>{const n=new Event(t);e.dispatchEvent(n)},on=new ResizeObserver(e=>{for(const t of e){const e=t.target;rn(e,"resize")}}),sn=(e={})=>nn("slot",e),an=e=>document.createTextNode(e),cn=(e,t)=>{if(t)if("string"==typeof t)e.textContent=t;else if(Array.isArray(t))t.forEach(t=>{e.appendChild(t.cloneNode?t.cloneNode(!0):an(t))});else{if(!t.cloneNode)throw new Error("expect text content or document node");e.appendChild(t.cloneNode(!0))}};var ln=Object.freeze({__proto__:null,fragment:(...e)=>{const t=document.createDocumentFragment();return e.forEach(e=>t.appendChild(e.cloneNode(!0))),t},makeElement:nn,makeWebComponent:(e,{superClass:t=HTMLElement,value:n=!1,style:r=!1,methods:o={},eventHandlers:s={},props:a={},attributes:i={},content:c=sn(),role:l=!1})=>{let d=null;r?(r=Object.assign({":host([hidden])":{display:"none !important"}},r),d=nn("style",{content:(e=>"object"==typeof e?Object.keys(e).map(t=>{const n=e[t];return`${t} {\n${Object.keys(n).map(e=>`  ${(e=>e.replace(/[A-Z]/g,e=>"-"+e.toLowerCase()))(e)}: ${n[e]};`).join("\n")}\n}`}).join("\n\n"):e)(r)})):r&&console.debug("b8r-error",`style for a web-component ${e} with now shadowRoot is not supported`),o.render&&(o=Object.assign({queueRender(e=!1){this._changeQueued||(this._changeQueued=e),this._renderQueued||(this._renderQueued=!0,requestAnimationFrame(()=>{this._changeQueued&&rn(this,"change"),this._changeQueued=!1,this._renderQueued=!1,this.render()}))}},o));const u=class extends t{constructor(){super();for(const e of Object.keys(a)){const t=a[e];"function"!=typeof t?this[e]=t:Object.defineProperty(this,e,{enumerable:!1,get(){return t.call(this)},set(n){if(1!==t.length)throw new Error(`cannot set ${e}, it is read-only`);t.call(this,n)}})}const e=this;if(this.elementRefs=new Proxy({},{get(t,n){if(!t[n]){const r=e.shadowRoot.querySelector(`[data-id="${n}"]`);if(!r)throw new Error(`elementRef "${n}" does not exist!`);r.removeAttribute("data-id"),t[n]=r}return t[n]},set(){throw new Error("elementRefs is read-only")}}),d){const e=this.attachShadow({mode:"open"});e.appendChild(d.cloneNode(!0)),cn(e,c)}else cn(this,c);Object.keys(s).forEach(e=>{const t=!!e.startsWith("touch")&&{passive:!0};this.addEventListener(e,s[e].bind(this),t)}),s.childListChange&&new MutationObserver(s.childListChange.bind(this)).observe(this,{childList:!0});const t=Object.keys(i);if(t.length){const e={};new MutationObserver(e=>{let n=!1,r=!1;e.forEach(e=>{n="value"===e.attributeChange,r=r||n||t.includes(e.attributeName)}),r&&this.queueRender&&this.queueRender(n)}).observe(this,{attributes:!0}),t.forEach(t=>{Object.defineProperty(this,t,{enumerable:!1,get(){return"boolean"==typeof i[t]?this.hasAttribute(t):this.hasAttribute(t)?"number"==typeof i[t]?parseFloat(this.getAttribute(t)):this.getAttribute(t):void 0!==e[t]?e[t]:i[t]},set(n){"boolean"==typeof i[t]?n!==this[t]&&(n?this.setAttribute(t,""):this.removeAttribute(t),this.queueRender&&this.queueRender("value"===t)):"number"==typeof i[t]?n!==parseFloat(this[t])&&(this.setAttribute(t,n),this.queueRender&&this.queueRender("value"===t)):"object"!=typeof n&&`${n}`===`${this[t]}`||(null===n||void 0===n||"object"==typeof n?this.removeAttribute(t):this.setAttribute(t,n),e[t]=n,this.queueRender&&this.queueRender("value"===t))}})})}this.queueRender&&this.queueRender()}connectedCallback(){l&&this.setAttribute("role",l),s.resize&&on.observe(this),o.connectedCallback&&o.connectedCallback.call(this)}disconnectedCallback(){on.unobserve(this)}static defaultAttributes(){return{...i}}};return Object.keys(o).forEach(e=>{"connectedCallback"!==e&&(u.prototype[e]=o[e])}),window.customElements&&window.customElements.define(e,u),u},div:(e={})=>nn("div",e),slot:sn,input:(e={})=>nn("input",e),button:(e={})=>nn("button",e),label:(e={})=>nn("label",e),span:(e={})=>nn("span",e),text:an,dispatch:rn});const dn={constants:n,id:f};var un,fn;Object.assign(dn,J),Object.assign(dn,S),Object.assign(dn,{on:Dt,off:Bt,enable:(e,t)=>{(t?q(e,"[data-event-disabled]",!0):[e]).forEach(e=>{e.dataset.eventDisabled&&(e.dataset.event=e.dataset.eventDisabled,e.dataset.eventDisabled&&delete e.dataset.eventDisabled),e.disabled&&(e.disabled=!1)})},disable:(e,t)=>{(t?q(e,"[data-event]",!0):[e]).forEach(e=>{e.dataset.event&&(e.dataset.eventDisabled=e.dataset.event,e.dataset.event&&delete e.dataset.event),e.disabled||(e.disabled=!0)})},trigger:Wt,callMethod:qt,implicitlyHandleEventsOfType:e=>{-1===St.indexOf(e)&&(St.push(e),document.body.addEventListener(e,Ft,!0))}}),Object.assign(dn,{addDataBinding:(e,t,n)=>{const r=`${t}=${n=n.replace(/\b_component_\b/g,ce(e))}`,o=(e.dataset.bind||"").split(";").map(e=>e.trim()).filter(e=>!!e);-1===o.indexOf(r)&&(o.push(r),e.dataset.bind=o.join(";"),delete e._b8rBoundValues,X(e))},removeDataBinding:(e,t,n)=>{const r=`${t}=${n}`;var o=(e.dataset.bind||"").split(";").map(e=>e.trim());o.indexOf(r)>-1&&((o=o.filter(e=>e!==r)).length?e.dataset.bind=o.join(";"):e.dataset.bind&&delete e.dataset.bind,delete e._b8rBoundValues)},getDataPath:ie,getComponentId:ce,getListPath:e=>{const t=e.closest("[data-list-instance]"),n=t&&F(t,"[data-list]");return n&&n.dataset.list.split(":")[0]},getListInstancePath:e=>{const t=e.closest("[data-list-instance]");return t?t.dataset.listInstance:null}}),Object.assign(dn,{onAny:function(...e){const{eventType:t,path:n}=tn(e);Dt(kt,t,n)},offAny:function(...e){const{eventType:t,path:n}=tn(e);Bt(kt,t,n)},anyListeners:()=>Nt(kt)}),Object.assign(dn,Ot),Object.assign(dn,Te),dn.observe(()=>!0,(e,t)=>((...e)=>{let t,n,r,o;e[1]instanceof HTMLElement?[t,n]=e:([r,o,n]=e,t=o&&"/"!==o?r+("["!==o[0]?".":"")+o:r),G(t,n)})(e,t)),dn.keystroke=Pt,dn.modifierKeys=Tt,dn.webComponents=ln,Object.assign(dn,qe),dn.cleanupComponentInstances=dn.debounce(()=>{dn.forEachKey($n,(e,t)=>{dn.isInBody(e)&&e.dataset.componentId===t||delete $n[t]}),dn.models().forEach(e=>{"c#"!==e.substr(0,2)||$n[e]||(dn.callIf(`${e}.destroy`),dn.remove(e,!1))})},100),Object.assign(dn,{asyncUpdate:G,afterUpdate:e=>{K.length?-1===Z.indexOf(e)&&Z.push(e):e()},touchElement:X}),dn.forceUpdate=(()=>{let e;for(;e=Y();){const t=dn.find("[data-list]").map(e=>({elt:e,listBinding:e.dataset.list}));let n=!1;for(;e.length;){const{path:r,source:o}=e.shift();try{r?(t.filter(e=>e.elt!==o&&e.listBinding.includes(r)).forEach(({elt:e})=>yn(e)),n||(n=dn.find("[data-bind]").map(e=>({elt:e,data_binding:e.dataset.bind}))),n.filter(e=>e.elt!==o&&e.data_binding.includes(r)).forEach(e=>{e.dirty=!0})):dn.bindAll(o)}catch(e){console.debug("b8r-error","update error",e,{path:r,source:o})}}n&&n.forEach(({elt:e,dirty:t})=>t&&bn(e))}dn.cleanupComponentInstances(),(()=>{for(;Z.length;){let e;try{(e=Z.shift())()}catch(t){console.debug("b8r-error","_afterUpdate_callback error",t,e)}}})()}),un=dn.forceUpdate,Q=un,dn.setByPath=function(...e){let t,n,r,o;if(2===e.length&&"object"==typeof e[1]&&!Array.isArray(e[1]))return[t,r]=e,void dn.forEachKey(r,(e,n)=>dn.setByPath(t,n,e));2===e.length||e[2]instanceof Element?([n,r,o]=e,n=dn.resolvePath(n,o),[t,n]=g(n)):[t,n,r,o]=e,dn.registered(t)?"object"==typeof n?dn.set(t,n,o):dn.set("["!==n[0]&&n?`${t}.${n}`:`${t}${n}`,r,o):console.debug("b8r-error",`setByPath failed; ${t} is not a registered model`)},fn=dn.set,Ke=fn,Ze=Gt;const pn=(e,t)=>{dn.touch(e+(t.startsWith("[")?t:"."+t))};dn.pushByPath=function(...e){let t,n,r,o;if(2===e.length||"function"==typeof e[2]?([n,r,o]=e,[t,n]=g(n)):[t,n,r,o]=e,dn.registered(t)){const e=dn.get(n?`${t}.${n}`:t);e.push(r),o&&o(e),pn(t,n)}else console.debug("b8r-error",`pushByPath failed; ${t} is not a registered model`)},dn.unshiftByPath=function(...e){let t,n,r;if(2===e.length?([n,r]=e,[t,n]=g(n)):[t,n,r]=e,dn.registered(t)){A(dn.get(t),n).unshift(r),pn(t,n)}else console.debug("b8r-error",`unshiftByPath failed; ${t} is not a registered model`)},dn.removeListInstance=function(e){e=e.closest("[data-list-instance]"),dn.remove(e.dataset.listInstance)},dn.listItems=(e=>dn.makeArray(e.children).filter(e=>e.matches("[data-list-instance]"))),dn.listIndex=(e=>dn.listItems(e.parentElement).indexOf(e)),dn.getComponentData=((e,t)=>{const n=ce(e,t);return n?dn.get(n):null}),dn.setComponentData=((e,t,n)=>{const r=ce(e);dn.setByPath(r,t,n)}),dn.getData=(e=>{const t=dn.getDataPath(e);return t?dn.get(t,e):null}),dn.getListInstance=(e=>{const t=dn.getListInstancePath(e);return t?dn.get(t,e):null}),dn.setListInstance=((e,t)=>{const n=dn.getListInstance(e),r=dn.getListInstancePath(e),o=t(n);dn.set(r,o),dn.find(`[data-list-instance="${r}"]`).forEach(dn.touchElement)}),dn.getListTemplate=(e=>{e=e.closest("[data-list-instance]");do{e=e.nextElementSibling}while(!e.matches("[data-list]"));return e}),document.body?St.forEach(e=>document.body.addEventListener(e,Ft,!0)):document.addEventListener("DOMContentLoaded",()=>{St.forEach(e=>document.body.addEventListener(e,Ft,!0))});const hn=function(e){const t={_true_:e=>!0===e,_false_:e=>!1===e,_undefined_:e=>void 0===e,_null_:e=>null===e,_empty_:e=>"string"==typeof e&&!!e.trim()},n=(e,n)=>("string"==typeof n&&(n=n.replace(/&nbsp;/g,"").trim()),Object.prototype.hasOwnProperty.call(t,e)?t[e](n):void 0!==e?n==e:!!n),r=e=>{if(!e)throw new Error("expected options");return e.split("|").map(e=>e.trim()).filter(e=>!!e).map(e=>1===(e=e.split(":").map(e=>e.trim())).length?{value:e[0]}:{match:e[0],value:e[1]})};return{value:(t,n)=>{switch("number"===t.dataset.type&&(n=parseFloat(n)),t.getAttribute("type")){case"radio":t.checked!==(t.value==n)&&(t.checked=t.value==n);break;case"checkbox":t.checked=n;break;default:t.dataset.componentId?e.set(`${t.dataset.componentId}.value`,n):"file"===t.type?n?console.debug("b8r-error","cannot set file input value except to clear it",t,n):t.value="":void 0!==t.value?(t.value=n,t instanceof HTMLSelectElement&&(n&&!t.value?t.dataset.pendingValue=JSON.stringify(n):t.dataset.pendingValue&&delete t.dataset.pendingValue)):t.tagName.includes("-")||console.debug("b8r-error","could not set component value",t,n)}},checked:(e,t)=>{null===t?(e.checked=!1,e.indeterminate=!0):(e.indeterminate=!1,e.checked=!!t)},selected:(e,t)=>{e.selected=!!t},text:(e,t)=>{e.textContent=t},format:(t,n)=>{let r=n||"";if("string"!=typeof r)throw new Error("format only accepts strings or falsy values");let o=!1;r.match(/[*_]/)&&!r.match(/<|>/)&&(o=!0,r=r.replace(/[*_]{2,2}(.*?)[*_]{2,2}/g,"<b>$1</b>").replace(/[*_](.*?)[*_]/g,"<i>$1</i>")),r.indexOf("${")>-1&&(r=e.interpolate(r,t)),o?t.innerHTML=r:t.textContent=r},fixed:(e,t,n)=>{e.textContent=parseFloat(t).toFixed(n||1)},bytes:(e,t)=>{if(!t)return void(e.textContent="");const n=["B","kB","MB","GB","TB","PB","EB"];let r=n.shift();for(e.title=`${t} bytes`;t>1024&&r.length;)t=(t/1024).toFixed(1),r=n.shift();e.textContent=`${t} ${r}`},attr:function(e,t,n){void 0===t||null===t||!1===t?e.removeAttribute(n):(e.setAttribute(n,t),"src"===n&&"function"==typeof e.load&&e.load())},href:function(e,t){t?e.setAttribute("href",t):e.removeAttribute("href")},prop:function(e,t,n){e[n]=t},data:function(e,t,n){void 0===t||null===t||!1===t?delete e.dataset[n]:e.dataset[n]=t},img:Ct,bgImg:(e,t)=>{e.style.backgroundImage=t?`url("${t}")`:""},style:function(e,t,n){if(n){if(void 0!==t){const[r,o]=n.split("|");e.style[r]=o?`${t}${o}`:t}}else"string"==typeof t?e.setAttribute("style",n):"object"==typeof t&&Object.assign(e.style,t)},class:function(e,t,n){if(!n)throw new Error("class toTarget requires a class to be specified");const o=r(n);e.classList.toggle(o[0].value,!!t),o.length>1&&e.classList.toggle(o[1].value,!t)},classUnless:function(e,t,n){if(!n)throw new Error("classUnless toTarget requires a class to be specified");e.classList.toggle(n,!t)},classMap:function(e,t,o){let s=!1;r(o).forEach(r=>{s||r.match&&!n(r.match,t)?e.classList.remove(r.value):(e.classList.add(r.value),s=!0)})},contenteditable:function(e,t,r){n(r,t)?e.setAttribute("contenteditable",!0):e.removeAttribute("contenteditable")},enabledIf:function(t,r,o){n(o,r)?e.enable(t):e.disable(t)},disabledIf:function(t,r,o){n(o,r)?e.disable(t):e.enable(t)},pointerEventsIf:function(e,t){e.style.pointerEvents=t?"auto":"none"},pointerEventsOffIf:function(e,t){e.style.pointerEvents=t?"none":"auto"},showIf:function(t,r,o){n(o,r)?e.show(t):e.hide(t)},hideIf:function(t,r,o){n(o,r)?e.hide(t):e.show(t)},method:function(t,n,r){let[o,...s]=r.split(".");s=s.join("."),"_component_"===o&&(o=Rt(t,s)),o?e.callMethod(o,s,t,n,r):t.closest("body")&&console.debug("b8r-warn",`method ${s} not found in`,t)},timestamp:function(e,t,n){if(t)if(n){const r=new Date(t);e.textContent=r.format(n)}else{const n=new Date(t);e.textContent=n.toLocaleString()}else e.textContent=""},json:function(e,t){try{e.textContent=JSON.stringify(t,!1,2)}catch(n){const r={};Object.keys(t).forEach(e=>{r[e]=function e(t,n=4,r=!1){if(void 0===t)return"undefined";if(!Array.isArray(t)){if(t&&t.constructor===Object){const e=Object.keys(t);return n>=0&&e.length>n&&(e.splice(n),e.push("…")),`{${e.sort().join(",")}}`}if("string"==typeof t)return r?"string":`"${t}"`;if(t instanceof Function){const e=t.toString(),n=e.match(/^(async\s+)?(function[^(]*\()?\(?(.*?)(\)\s*\{|\)\s*=>|=>)/m)[3].trim(),r=e.match(/\[native code\]/),o=r?"[native code]":"...";let s=t.prototype||r?`function(${n}){${o}}`:`(${n})=>{${o}}`;return e.startsWith("async")&&(s="async "+s),s}return isNaN(t)?"NaN":"boolean"==typeof t?r?"bool":""+t:"number"==typeof t?r?"#":""+t:JSON.stringify(t)}return 0===t.length?"[]":1===t.length||typeof t[0]==typeof t[1]?`[${e(t[0],n,r)} × ${t.length}]`:typeof t[0]!=typeof t[1]?t.length<=n||n<0?"["+t.map(t=>e(t,n,r)).join(", ")+"]":`[* × ${t.length}]`:void 0}(t[e])}),e.textContent="/* partial data -- could not stringify */\n"+JSON.stringify(r,!1,2)}},dataPath:function(t,n){(!t.dataset.path||n&&t.dataset.path.substr(-n.length)!==n)&&(t.dataset.path=n,e.bindAll(t))},component:function(t,n,r){const o=e.getComponentId(t);e.setByPath(o,r,n)},componentMap:function(t,n,o){const s=r(o).find(e=>!e.match||e.match==n);if(s){const n=s.value;-1===(t.dataset.componentId||"").indexOf(`c#${n}#`)&&(e.removeComponent(t),e.insertComponent(n,t))}}}}(dn);dn.onAny(["change","input"],"_b8r_._update_"),dn.interpolate=((e,t)=>{let n;if(e.match(/\$\{[^{]+\}|\{\{[^{]+\}\}/)){n=e;do{n=n.replace(/\$\{([^{]+?)\}|\{\{([^{]+?)\}\}/g,(e,n,r)=>{const o=dn.get(n||r,t);return null!==o?o:""})}while(n.match(/\$\{[^{]+\}|\{\{[^{]+\}\}/))}else{const r=se(e);if(r.indexOf("")>-1)throw new Error(`empty path in binding ${e}`);1===(n=r.map(e=>dn.get(e,t))).length&&(n=n[0])}return n});const mn=(e,t)=>e!==t||e&&"object"==typeof e;function bn(e){if(e.tagName.includes("-")&&e.constructor===HTMLElement)return void te(e.tagName);if(e.closest(re))return;e.matches("[data-debug],[data-debug-bind]")&&console.debug("b8r-warn","Add a conditional breakpoint here to watch changes to the DOM caused by changes in the registry");const t=ae(e),n=e._b8rBoundValues||(e._b8rBoundValues={}),r={};for(let o=0;o<t.length;o++){const{targets:s,path:a}=t[o],i=dn.interpolate(a,e),c=n[a];if(mn(c,i)){r[a]=i;const t=[];for(const n of s)hn[n.target]?t.push(n):Gt[n.target]||console.debug("b8r-warn",`unrecognized target ${n.target} in ${e.dataset.bind}`,e);t.forEach(t=>{hn[t.target](e,i,t.key)})}}Object.assign(n,r)}dn.show=((e,...t)=>{void 0===e.dataset.origDisplay&&(e.dataset.origDisplay="none"===e.style.display?"":e.style.display),e.style.display=e.dataset.origDisplay,q(e,'[data-event*="show"]',!0).forEach(e=>Wt("show",e,...t))}),dn.hide=((e,...t)=>{L(e)&&(void 0===e.dataset.origDisplay&&(e.dataset.origDisplay=e.style.display,q(e,'[data-event*="hide"]',!0).forEach(e=>Wt("hide",e,...t))),e.style.display="none")});const gn=(e,t,n)=>{if(Array.isArray(e))for(let r=e.length-1;r>=0;r--){const o=e[r];n(o,t?`${t}=${A(o,t)}`:r)}else if(e.constructor===Object){if(t)throw new Error("id-path is not supported for objects bound as lists");const r=Object.keys(e);for(let t=r.length-1;t>=0;t--){const o=r[t];n(e[o],`=${o}`)}}else if(null!==e)throw new Error("can only bind Array and Object instances as lists")};function yn(e){if(e.classList.add("-b8r-empty-list"),!e.parentElement||e.parentElement.closest(re))return;const[t,n]=e.dataset.list.split(":").map(e=>e.trim());let r,o,s;try{[,,r,s]=t.match(/^(([^()]*)\()?([^()]*)(\))?$/),s=s.split(",").map(e=>e.trim()),o=s[0]}catch(e){console.debug("b8r-error","bindList failed; bad source path",t)}const a=dn.resolvePath(o,e);if(a!==o){let t=o=a;r&&(s.shift(),s=[o,...s.map(t=>dn.resolvePath(t,e))],t=`${r}(${s.join(",")})`),e.dataset.list=n?`${t}:${n}`:t}let i=dn.get(o);if(!i){for(const t of Object.values(e._b8rListInstances||{}))t.remove();return void e.classList.add("-b8r-empty-list")}if(r&&!n)throw new Error(`data-list="${e.dataset.list}" -- computed list requires id-path`);if(r){if(!dn.get(r))return;if((()=>{try{const t=s.map(dn.get),n=dn.callMethod(r,...t,e);Array.isArray(i)&&n.length&&-1===i.indexOf(n[0])&&console.debug("b8r-warn",`list filter ${r} returned a new object`+" (not from original list); this will break updates!"),i=n}catch(e){console.debug("b8r-error",`bindList failed, ${r} threw error`,e)}})(),!i)throw new Error("could not compute list; async filtered list methods not supported (yet)")}if("_auto_"===n)for(let e=0;e<i.length;e++)void 0===i[e]._auto_&&(i[e]._auto_=f());dn.show(e);const c=e._b8rListInstances||{},l=e._b8rListInstances={},d=e.cloneNode(!0);d.classList.remove("-b8r-empty-list"),0===d.classList.length&&d.removeAttribute("class"),delete d.dataset.list,"OPTION"===e.tagName&&(e.setAttribute("disabled",""),e.textContent="",d.removeAttribute("disabled"));let u,p=e,h=!1;const m={};e.classList.toggle("-b8r-empty-list",!i.length),gn(i,n,(t,r)=>{if(m[r])return void console.debug("b8r-warn",`${r} not unique ${n} in ${e.dataset.list}`);m[r]=!0;const s=`${o}[${r}]`;void 0===(u=c[s])?(h=!0,(u=d.cloneNode(!0)).dataset.listInstance=s,u._b8rListInstance=t,e.parentElement.insertBefore(u,p),de(u,s),dn.bindAll(u)):(delete c[s],u.nextSibling!==p&&e.parentElement.insertBefore(u,p)),l[s]=u,p=u}),dn.forEachKey(c,e=>{h=!0,e.remove()}),h&&dn.trigger("change",e.parentElement),dn.hide(e)}var vn;dn.bindAll=(e=>{e=e,dn.findWithin(e||document.body,ne,!0).forEach(e=>{if(!e.closest("[data-list]")){const t="B8R-COMPONENT"===e.tagName?e.name:e.dataset.component;t&&dn.insertComponent(t,e)}}),(e=>q(e,"[data-bind]",!0))(e).forEach(bn),(e=>q(e,"[data-list]",!0))(e).forEach(yn)}),Object.assign(dn,Be),Object.assign(dn,Yt),dn.onRequest(()=>{dn.registered("b8rRequestInFlight")?dn.set("b8rRequestInFlight",dn.ajaxRequestsInFlight()):dn.register("b8rRequestInFlight",dn.ajaxRequestsInFlight())});Object.assign(dn,{component:(e,t,n=!1)=>{if(void 0===t&&(e=(t=e).split("/").pop().split(".").shift()),!He[e]||n){if(!t)throw new Error(`expected component ${e} to be defined`);t=(e=>{for(;e.match(/([^/]+\/\.\.\/)/);)e=e.replace(/([^/]+\/\.\.\/)/g,"");return e})(t),He[e]=new Promise(function(r,o){if(Fe[e]&&!n)r(Fe[e]);else if(t.match(/\.m?js$/))import(t).then(n=>{if(Fe[e])r(Fe[e]);else if(n.default&&"object"==typeof n.default)r(Ve(e,n.default));else{const n=`cannot define component "${e}", ${t} does not export a component definition as default`;console.debug("b8r-error",n),o(n)}}).catch(n=>{delete He[e],console.debug("b8r-error",n,`failed to import component ${t}`),o(n)});else{const s=t.match(/\.\w+$/)?t:`${t}.component.html`;Le(s).then(o=>r(Ve(e,o,t,n))).catch(n=>{delete He[e],console.debug("b8r-error",n,`failed to load component ${t}`),o(n)})}})}return He[e]},makeComponent:Ve,makeComponentNoEval:Je}),dn.components=(()=>Object.keys(Fe)),dn._DEPRECATED_COMPONENTS_PASS_DOWN_DATA=!1;let wn=0;const $n={};dn.insertComponent=async function(e,t,n){if(!e)throw new Error("insertComponent requires a component");const r="string"==typeof n?n:dn.getDataPath(t);if(t){if(!dn.isInBody(t))return}else t=dn.create("div");if("string"==typeof e){if(!Fe[e])return We[e]||(We[e]=setTimeout(()=>console.debug("b8r-error","component timed out: ",e),5e3)),n&&((e,t)=>{t&&(en(e),Xt.push({targetElement:e,data:t}))})(t,n),void(t.dataset.component=e);e=Fe[e]}const o=e.name+"-component";if(t.classList.contains(o))return;t.dataset.component&&delete t.dataset.component,n&&!r||(n=((e,t)=>{for(var n,r=0;r<Xt.length;r++)if(Xt[r].targetElement===e)return n=Xt[r].data,en(e),n;const o=e.dataset.json;return o?JSON.parse(o):t})(t)||(e=>{const t=["destroy"],n=dn._DEPRECATED_COMPONENTS_PASS_DOWN_DATA?"[data-path],[data-list-instance],[data-component-id]":"[data-path],[data-list-instance]",r=e.closest(n);if(r){const e=dn.get(r.dataset.componentId||dn.getDataPath(r));return dn.filterObject(e||{},(e,n)=>!t.includes(n)||"function"!=typeof e)}return null})(t)||{}),null===t.parentElement&&document.body.appendChild(t);const s=dn.fragment(),a="c#"+e.name+"#"+ ++wn;for(const n of e.view.getAttributeNames())t.setAttribute(n,e.view.getAttribute(n));if(e.view.children.length){dn.moveChildren(t,s);const n=e.view.querySelector("[data-parent]")||e.view;dn.copyChildren(n,t);const o=dn.findOneWithin(t,"[data-children]");s.firstChild&&o&&(dn.empty(o),dn.moveChildren(s,o)),le(t,"_component_",a),r&&le(t,"_data_",r)}dn.makeArray(t.classList).forEach(e=>{"-component"===e.substr(-10)&&t.classList.remove(e)});const i=e=>dn.getByPath(a,e),c=(...e)=>{1===e.length&&e[0]&&e[0].constructor===Object?Object.assign(dn.reg[a],e[0]):(dn.setByPath(a,...e),("value"===e[0]||Object.prototype.hasOwnProperty.call(e[0],"value"))&&dn.trigger("change",t))},l=e=>{console.debug("b8r-warn","use of register withi components is deprecated, use data or set() instead"),c(e)},d=e=>pn(a,e),u=(...e)=>dn.on(t,...e),f=e=>dn.findWithin(t,e),p=e=>dn.findOneWithin(t,e);t.classList.add(o),t.setAttribute("data-initializing",""),t.dataset.componentId=a;const h="function"==typeof e.initialValue?await e.initialValue({b8r:dn,get:i,set:c,touch:d,on:u,component:t,findOne:p,find:f}):dn.deepClone(e.initialValue)||n;if(n={...e.type?dn.deepClone(e.type):{},...h,dataPath:r,componentId:a},dn.register(a,n,!0),t.removeAttribute("data-initializing"),$n[a]=t,e.load)try{await e.load(t,(e=>e?Object.assign({},dn,{_path:e,component:(...t)=>{const n=t[1]?1:0;let r=t[n];return-1===r.indexOf("://")&&(r=`${e}/${r}`,t[n]=r),dn.component(...t)}}):dn)(e.path),f,p,dn.reg[a],l,i,c,u,d,e)}catch(t){console.debug("b8r-error","component",e.name,"failed to load",t)}dn.bindAll(t),En.get(t)&&dn.afterUpdate(()=>{En.get(t).resolve()})};const En=new WeakMap;return dn.Component=dn.webComponents.makeWebComponent("b8r-component",{attributes:{name:"",path:""},content:!1,props:{componentId(){return this.dataset.componentId},value(e){if(void 0===e)return this.state.value;void 0!==this.state.value&&(this.state.value=e)},data(){return dn.reg[this.dataset.componentId]}},methods:{connectedCallback(){const{path:e}=this;e&&(this.name||(this.name=e.split("/").pop().split(".").shift()),dn.component(this.name,e))},get(e="."){return dn.getByPath(this.componentId,e)},set(...e){dn.setByPath(this.componentId,...e)},async ready(){if(this.componentId&&this.data)return!0;if(!En.get(this)){const e={},t=new Promise(t=>{e.resolve=(()=>{t(),En.delete(this)}),En.set(this,e)});e.promise=t}return En.get(this).promise},empty(){this.textContent="",dn.removeComponent(this)},render(){if(!this.isConnected)return;this.parentElement&&this.parentElement.closest(re)||(this.name?this.closest("[data-list]")||dn.insertComponent(this.name,this):dn.removeComponent(this))}}}),dn.wrapWithComponent=((e,t,n,r)=>{const o=dn.create("div");return r&&dn.forEachKey(r,(e,t)=>o.setAttribute(t,e)),dn.wrap(t,o),dn.insertComponent(e,o,n),o}),dn.removeComponent=(e=>{e.dataset.componentId&&(delete e.dataset.componentId,dn.makeArray(e.classList).forEach(t=>{/-component$/.test(t)&&(e.classList.remove(t),dn.empty(e))}),dn.cleanupComponentInstances())}),dn.componentOnce=(async(...e)=>{const t=await dn.component(...e);dn.findOne(`[data-component-id*="${t.name}"]`)||await dn.insertComponent(t)}),Object.freeze(dn),dn}();
//# sourceMappingURL=dist/b8r.iife.min.js.map